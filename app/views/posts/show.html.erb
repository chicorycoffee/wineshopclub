<%= render "shared/header"%>

<div class="post-show">
  <div class="post-box">
   <h2 class="genre">
   <%=@post.genre.name %>
   </h2>
    <h2 class="title">
      <%= @post.title %>
    </h2>
    <h2 class="user-nickname" %>
    <%= "by " %>
    <%= link_to @post.user.nickname, "/users/#{@post.user.id}/profiles" %>
    </h2>
    <div class="post-img-content">
        <% if @post.image.attached? %>
        <%= image_tag @post.image, class: "post-box-img" %>
      <% else %>
        <img class="index-img" src="<%= "/images/test_sample.png" %>" alt="Index image cap">
      <% end %>
    </div>
    <div>
    <% if user_signed_in? && current_user.id == @post.user_id %>
    <%= link_to "商品の編集", edit_post_path(@post.id), method: :get, class: "post-red-btn" %>
    <p class="or-text">or</p>
    <%= link_to "削除", post_path(@post.id), method: :delete, class:"post-destroy" %>
    <% end %>
    </div>
<div>
    <% if current_user != @post.user %>
    <%= render 'post', post: @post %>
    <% end %>
</div>

    <table class="table-striped">
    <tbody>
        <tr>
          <th class="detail-item">商品名</th>
          <td class="detail-value"><%= @post.name %></td>
        </tr>
        <tr>
          <th class="detail-item">輸入業者・卸売業者名</th>
          <td class="detail-value">
          <% if @post.importer.present?%>
          <%= @post.importer %>
          <% else %>
          <%= "---" %>
          <% end %>
          </td>
        </tr>
        <tr>
          <th class="detail-item">産地</th>
          <td class="detail-value"><%= @post.country.name %></td>
        </tr>
        <tr>
          <th class="detail-item">ワインタイプ</th>
          <td class="detail-value"><%= @post.type.name %></td>
        </tr>
        <tr>
          <th class="detail-item">味わい</th>
          <td class="detail-value">
          <%= @post.taste.name %>
          </td>
        </tr>
        <tr>
          <th class="detail-item">主体のブドウ品種</th>
          <td class="detail-value"><%= @post.grape.name %></td>
        </tr>
         <tr>
          <th class="detail-item">参考上代価格帯(税抜)</th>
          <td class="detail-value"><%= @post.price.name %></td>
        </tr>
         <tr>
          <th class="detail-item">補足コメント</th>
          <td class="detail-value">
          <% if @post.text.present?%>
          <%= @post.text %>
          <% else %>
          <%= "---" %>
          <% end %>
          </td>
        </tr>
      </tbody>
      </table>

  <div class="container">
    <% if user_signed_in? %>
      <%= form_with(model: [@post, @comment], local: true) do |form| %>
        <%= form.text_area :text, placeholder: "コメントする", rows: "2" %>
        <%= form.submit "SEND" %>
      <% end %>
    <% else %>
      <strong><p>※※※ コメントの投稿には新規登録/ログインが必要です ※※※</p></strong>
    <% end %>
     <div class="comments">
      <h4>＜コメント一覧＞</h4>
      <% @comments.each do |comment| %>
        <p>
          <strong><%= link_to comment.user.nickname, user_profiles_path(comment.user.id) %>：</strong>
          <%= comment.text %>
        </p>
      <% end %>
    </div>   
  </div>
</div>
